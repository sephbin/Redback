using System;
using SD = System.Drawing;

using Rhino.Geometry;

using Grasshopper.Kernel;

namespace RhinoCodePlatform.Rhino3D.Projects.Plugin.GH
{
  public sealed class ProjectComponent_9a5dddd3 : GH_Component
  {
    readonly SD.Bitmap _icon = default;
    readonly string _scriptData = "ew0KICAidHlwZSI6ICJzY3JpcHQiLA0KICAic2NyaXB0Ijogew0KICAgICJsYW5ndWFnZSI6IHsNCiAgICAgICJpZCI6ICIqLioucHl0aG9uIiwNCiAgICAgICJ2ZXJzaW9uIjogIjMuKi4qIg0KICAgIH0sDQogICAgInRpdGxlIjogIlJlbGF0aXZlIFBhdGgiLA0KICAgICJ0ZXh0IjogIkl5TWpJeUJEYjI1emRHRnVkSE1nSXlNakl3MEtaMnh2WW1Gc0lGOWZkbUZ5WDE4TkNsOWZkbUZ5WDE4Z1BTQjdEUW9KSW1kMWFXUWlPaUkwTVdKa1kyUmxZaTAzTkRneUxUUTJNRGd0T0RjelppMDFPVFE1TURnek1HUmlORElpTEEwS0NRMEtDU0p1WVcxbElqb2lVbVZzWVhScGRtVWdVR0YwYUNJc0RRb0pJbTVwWTJ0dVlXMWxJam9pVW1Wc0lGQmhkR2dpTEEwS0NTSmtaWE5qY21sd2RHbHZiaUk2SWtOeVpXRjBaWE1nWVNCeVpXeGhkR2wyWlNCd1lYUm9JSFJ2SUZKb2FXNXZMMGRJSUdSdlkzVnRaVzUwSWl3TkNna2lhV052YmlJNklDSm5hRU52Ym5SbGJuUmNYRWxqYjI0dFVtVnNZWFJwZG1WUVlYUm9MbkJ1WnlJc0RRb05DZ2tpZEdGaWJtRnRaU0k2SWxKbFpHSmhZMnNpTEEwS0NTSnpaV04wYVc5dUlqb2lSbWxzWlhNaUxBMEtEUW9KSW1sdWNIVjBjeUk2V3cwS0NRbDdJbTVoYldVaU9pSlFZWFJvSWl3SkNTSnVhV05yYm1GdFpTSTZJbEFpTEFraWIySnFaV04wUVdOalpYTnpJam9pYVhSbGJTSXNDU0prWlhOamNtbHdkR2x2YmlJNklsQmhkR2dnZEc4Z1lYQndaVzVrTENCdmNpQkNiMjlzWldGdUlIUnZJR05vYjI5elpTQmpkWEp5Wlc1MElDaEdLVWR5WVhOemFHOXdjR1Z5SUc5eUlDaFVLVkpvYVc1dklHUnZZM1Z0Wlc1MExpSXNJSDBzRFFvSkNYc2libUZ0WlNJNklsSmxiR0YwYVhabElGQmhkR2dpTEFrSkNTSnVhV05yYm1GdFpTSTZJbElpTEFraWIySnFaV04wUVdOalpYTnpJam9pYVhSbGJTSXNDU0prWlhOamNtbHdkR2x2YmlJNklsSmxiR0YwYVhabElGQmhkR2dnYzNSeWFXNW5JaXdnZlN3TkNnbGRMQTBLQ1NKdmRYUndkWFJ6SWpwYkRRb0pDWHNpYm1GdFpTSTZJa1oxYkd3Z2NHRjBhQ0lzQ1FraWJtbGphMjVoYldVaU9pSkdJaXdKSW1SbGMyTnlhWEIwYVc5dUlqb2lSblZzYkNCUVlYUm9JbjBzRFFvSkNYc2libUZ0WlNJNklrUnBjbVZqZEc5eWVTQndZWFJvSWl3SkltNXBZMnR1WVcxbElqb2lSQ0lzQ1NKa1pYTmpjbWx3ZEdsdmJpSTZJa1JwY21WamRHOXllU0JRWVhSb0luMHNEUW9KQ1hzaWJtRnRaU0k2SWtacGJHVWdibUZ0WlNJc0NRa2libWxqYTI1aGJXVWlPaUpPSWl3SkltUmxjMk55YVhCMGFXOXVJam9pUm1sc1pTQnVZVzFsSW4wc0RRb0pYUTBLZlEwS0NRa05DbWx0Y0c5eWRDQnZjdzBLYVcxd2IzSjBJRkpvYVc1dkRRcHBiWEJ2Y25RZ2MyTnlhWEIwWTI5dWRHVjRkQ0JoY3lCell3MEtkSEo1T2cwS0NTTndjbWx1ZENoUUtRMEtDV2xtSUZBZ1BUMGdUbTl1WlRvTkNna0pVQ0E5SUVaaGJITmxEUW9KSTJsbUlHNXZkQ0JTT2cwS0NTTUpVaUE5SUNJaURRb0phV1lnZEhsd1pTaFFLU0E5UFNCMGVYQmxLRVpoYkhObEtUb2dEUW9KQ1dsbUlGQTZEUW9KQ1FsRVQwTWdQU0JTYUdsdWJ5NVNhR2x1YjBSdll5NUJZM1JwZG1WRWIyTXVVR0YwYUEwS0NRbGxiSE5sT2cwS0NRa0pSRTlESUQwZ2MzUnlLSE5sYkdZdVFYUjBjbWxpZFhSbGN5NVBkMjVsY2k1UGJsQnBibWRFYjJOMWJXVnVkQ2dwTGtacGJHVlFZWFJvS1EwS0NXVnNjMlU2RFFvSkNVUlBReUE5SUZBTkNna2pjSEpwYm5Rb1JFOURLUTBLQ1dsbUlHOXpMbkJoZEdndWFYTmthWElvUkU5REtUb05DZ2tKWkc5alJHbHlJRDBnUkU5RERRb0pDV1J2WTA1aGJXVWdQU0JPYjI1bERRb0paV3h6WlRvTkNna0paRzlqUkdseUxDQmtiMk5PWVcxbElEMGdiM011Y0dGMGFDNXpjR3hwZENoRVQwTXBEUW9KRFFvSlpHOWpSR2x5Y3lBOUlHUnZZMFJwY2k1emNHeHBkQ2h2Y3k1elpYQXBEUW9KSTNCeWFXNTBLQ0l4SUdSdlkwUnBjbk1pTEdSdlkwUnBjbk1wRFFvSmFXWWdVaUE5UFNCT2IyNWxPZzBLQ1FsU0lEMGdaRzlqVG1GdFpRMEtDWFJ5ZVRvTkNna0pjbVZzUkdseWN5QTlJRkl1YzNCc2FYUW9iM011YzJWd0tRMEtDV1Y0WTJWd2REb05DZ2tKY21Wc1JHbHljeUE5SUZ0ZERRb05DZzBLRFFvSlptOXlJSEJoZEdoVGRHVndJR2x1SUhKbGJFUnBjbk02RFFvSkNTTndjbWx1ZENnaWNHRjBhSE4wWlhBaUxDQndZWFJvVTNSbGNDa05DZ2tKYVdZZ2NHRjBhRk4wWlhBZ1BUMGdJaTRpT2cwS0NRa0paR1ZzSUdSdlkwUnBjbk5iTFRGZERRb05DZ2x5Wld4RWFYSnpJRDBnYkdsemRDaG1hV3gwWlhJb2JHRnRZbVJoSUhnNklIZ2dJVDBnSWk0aUxDQnlaV3hFYVhKektTa05DZ2tqY0hKcGJuUW9JbkpsYkVScGNuTWlMSEpsYkVScGNuTXBEUW9KSTNCeWFXNTBLQ0prYjJORWFYSnpJaXhrYjJORWFYSnpLUTBLQ1c1bGQwUnBjbk1nUFNCa2IyTkVhWEp6SzNKbGJFUnBjbk1OQ2dramNISnBiblFvSW01bGQwUnBjbk1pTEc1bGQwUnBjbk1wRFFvSmJtVjNSR2x5Y3lBOUlHeHBjM1FvYldGd0tHeGhiV0prWVNCNE9pQjRMbkpsY0d4aFkyVW9Jam9pTENBaU9pSXJiM011YzJWd0tTd2dibVYzUkdseWN5a3BEUW9KYm1WM1JHbHlJRDBnYjNNdWNHRjBhQzVxYjJsdUtDcHVaWGRFYVhKektRMEtEUW9KSTNCeWFXNTBLRzVsZDBScGNpa05DZ2xHSUQwZ2JtVjNSR2x5RFFvSmFXWWdiM011Y0dGMGFDNXBjMlJwY2lodVpYZEVhWElwT2cwS0NRbEVJRDBnYm1WM1JHbHlEUW9KQ1U0Z1BTQk9iMjVsRFFvSlpXeHpaVG9OQ2drSlJDd2dUaUE5SUc5ekxuQmhkR2d1YzNCc2FYUW9ibVYzUkdseUtRMEtaWGhqWlhCMElFVjRZMlZ3ZEdsdmJpQmhjeUJsT2cwS0NTTndjbWx1ZENobEtRMEtDVVlnUFNCU0RRb0pSQ3dnVGlBOUlHOXpMbkJoZEdndWMzQnNhWFFvVWlrPSIsDQogICAgInVyaSI6ICJyaGlub2NvZGU6Ly8vZ3Jhc3Nob3BwZXIvMS85YTVkZGRkMy1lNGM0LTRmMmMtOWFiOS00NTE4OTFlNDczNTUvIiwNCiAgICAiaWQiOiAiOWE1ZGRkZDMtZTRjNC00ZjJjLTlhYjktNDUxODkxZTQ3MzU1IiwNCiAgICAibmlja25hbWUiOiAiUmVsUGF0aCIsDQogICAgImRlc2NyaXB0aW9uIjogIkNyZWF0ZXMgYSByZWxhdGl2ZSBwYXRoIHRvIFJoaW5vL0dIIGRvY3VtZW50IiwNCiAgICAiaW1hZ2UiOiB7DQogICAgICAibGlnaHQiOiB7DQogICAgICAgICJ0eXBlIjogInN2ZyIsDQogICAgICAgICJkYXRhIjogIlBITjJaeUJwWkQwaVRHRjVaWEpmTWlJZ1pHRjBZUzF1WVcxbFBTSk1ZWGxsY2lBeUlpQjRiV3h1Y3owaWFIUjBjRG92TDNkM2R5NTNNeTV2Y21jdk1qQXdNQzl6ZG1jaUlIWnBaWGRDYjNnOUlqQWdNQ0F5TkNBeU5DSVx1MDAyQkNpQWdQR1JsWm5NXHUwMDJCQ2lBZ0lDQThjM1I1YkdVXHUwMDJCQ2lBZ0lDQWdJQzVqYkhNdE1TQjdDaUFnSUNBZ0lDQWdabWxzYkRvZ0kyVmtNV015TkRzS0lDQWdJQ0FnZlFvS0lDQWdJQ0FnTG1Oc2N5MHhMQ0F1WTJ4ekxUSXNJQzVqYkhNdE15QjdDaUFnSUNBZ0lDQWdjM1J5YjJ0bExYZHBaSFJvT2lBd2NIZzdDaUFnSUNBZ0lIMEtDaUFnSUNBZ0lDNWpiSE10TWlCN0NpQWdJQ0FnSUNBZ1ptbHNiRG9nSTJabVpqc0tJQ0FnSUNBZ2ZRb0tJQ0FnSUNBZ0xtTnNjeTB6SUhzS0lDQWdJQ0FnSUNCbWFXeHNPaUFqWXpReFlURmxPd29nSUNBZ0lDQjlDaUFnSUNBOEwzTjBlV3hsUGdvZ0lEd3ZaR1ZtY3o0S0lDQThjbVZqZENCamJHRnpjejBpWTJ4ekxUTWlJSGc5SWpNdU1URWlJSGs5SWpNdU5UTWlJSGRwWkhSb1BTSXlNQzQ0T1NJZ2FHVnBaMmgwUFNJeE5TNDJOaUlnY25nOUlqSXVOU0lnY25rOUlqSXVOU0l2UGdvZ0lEeHdZWFJvSUdOc1lYTnpQU0pqYkhNdE1pSWdaRDBpVFRJeExqUTVMRFF1TlRWakxqZ3lMREFzTVM0ME9TNDJOeXd4TGpRNUxERXVORGwyTXk0d09HTXRMak10TGpJekxTNDJOUzB1TXpndE1TNHdNaTB1TkRWMkxUSXVOVGhqTUMwdU1qZ3RMakl6TFM0MU1TMHVOVEV0TGpVeGFDMHhNQzR4TW13dExqUTRMVEV1TURKb01UQXVOalJhSWk4XHUwMDJCQ2lBZ1BIQmhkR2dnWTJ4aGMzTTlJbU5zY3kweUlpQmtQU0pOTWpBdU9UUXNPQzQyTW1ndE5pNDNNV010TGpVNExEQXRNaTR4TFRFdU16TXRNaTR6TlMweExqZzJiQzB1TURndExqRTJhRGt1TVROMk1pNHdNbG9pTHo0S0lDQThjR0YwYUNCamJHRnpjejBpWTJ4ekxURWlJR1E5SWsweUxqVXNNakl1TlRGakxURXVNemdzTUMweUxqVXRNUzR4TWkweUxqVXRNaTQxVmpNdU9UbERNQ3d5TGpZeExERXVNVElzTVM0ME9Td3lMalVzTVM0ME9XZzJMakl5WXpFdU16Z3NNQ3d5TGpjNExERXVNRGtzTXk0eE15d3lMalF5YkM0ek15d3hMakkzWXk0ek5Td3hMak16TERFdU56VXNNaTQwTWl3ekxqRXpMREl1TkRKb05pNHlZekV1TXpnc01Dd3lMalVzTVM0eE1pd3lMalVzTWk0MWRqa3VPVEZqTUN3eExqTTRMVEV1TVRJc01pNDFMVEl1TlN3eUxqVklNaTQxV2lJdlBnbzhMM04yWno0PSINCiAgICAgIH0NCiAgICB9LA0KICAgICJncm91cCI6ICJGaWxlcyIsDQogICAgImlucHV0cyI6IFsNCiAgICAgIHsNCiAgICAgICAgIm5hbWUiOiAiUCIsDQogICAgICAgICJ0eXBlIjogew0KICAgICAgICAgICJuYW1lIjogIlN5c3RlbS5PYmplY3QiDQogICAgICAgIH0sDQogICAgICAgICJwcmV0dHkiOiAiUCIsDQogICAgICAgICJkZXNjIjogInJoaW5vc2NyaXB0c3ludGF4IGdlb21ldHJ5Ig0KICAgICAgfSwNCiAgICAgIHsNCiAgICAgICAgIm5hbWUiOiAiUiIsDQogICAgICAgICJ0eXBlIjogew0KICAgICAgICAgICJuYW1lIjogIlN5c3RlbS5PYmplY3QiDQogICAgICAgIH0sDQogICAgICAgICJwcmV0dHkiOiAiUiIsDQogICAgICAgICJkZXNjIjogInJoaW5vc2NyaXB0c3ludGF4IGdlb21ldHJ5Ig0KICAgICAgfQ0KICAgIF0sDQogICAgIm91dHB1dHMiOiBbDQogICAgICB7DQogICAgICAgICJuYW1lIjogIkYiLA0KICAgICAgICAidHlwZSI6IHsNCiAgICAgICAgICAibmFtZSI6ICJTeXN0ZW0uT2JqZWN0Ig0KICAgICAgICB9LA0KICAgICAgICAic3RyaWN0IjogZmFsc2UsDQogICAgICAgICJwcmV0dHkiOiAiRiIsDQogICAgICAgICJkZXNjIjogInJoaW5vc2NyaXB0c3ludGF4IGdlb21ldHJ5Ig0KICAgICAgfSwNCiAgICAgIHsNCiAgICAgICAgIm5hbWUiOiAiRCIsDQogICAgICAgICJ0eXBlIjogew0KICAgICAgICAgICJuYW1lIjogIlN5c3RlbS5PYmplY3QiDQogICAgICAgIH0sDQogICAgICAgICJzdHJpY3QiOiBmYWxzZSwNCiAgICAgICAgInByZXR0eSI6ICJEIiwNCiAgICAgICAgImRlc2MiOiAicmhpbm9zY3JpcHRzeW50YXggZ2VvbWV0cnkiDQogICAgICB9LA0KICAgICAgew0KICAgICAgICAibmFtZSI6ICJOIiwNCiAgICAgICAgInR5cGUiOiB7DQogICAgICAgICAgIm5hbWUiOiAiU3lzdGVtLk9iamVjdCINCiAgICAgICAgfSwNCiAgICAgICAgInN0cmljdCI6IGZhbHNlLA0KICAgICAgICAicHJldHR5IjogIk4iLA0KICAgICAgICAiZGVzYyI6ICJyaGlub3NjcmlwdHN5bnRheCBnZW9tZXRyeSINCiAgICAgIH0NCiAgICBdDQogIH0NCn0=";
    readonly dynamic _script;

    public override Guid ComponentGuid { get; } = new Guid("9a5dddd3-e4c4-4f2c-9ab9-451891e47355");

    public override GH_Exposure Exposure { get; } = GH_Exposure.primary;

    public override bool Obsolete { get; } = false;

    protected override SD.Bitmap Icon => _icon;

    public ProjectComponent_9a5dddd3() : base(
        name: "Relative Path",
        nickname: "RelPath",
        description: "Creates a relative path to Rhino/GH document",
        category: "Redback-Beta",
        subCategory: "Files"
        )
    {
      bool success = ProjectComponentPlugin.TryCreateScript(this, _scriptData, out _script);
      if (success)
      {
        ProjectComponentPlugin.TryCreateScriptIcon(_script, out _icon);
      }
      else
      {
        AddRuntimeMessage(GH_RuntimeMessageLevel.Error, "Scripting platform is not ready.");
      }
    }

    protected override void RegisterInputParams(GH_InputParamManager _) { }

    protected override void RegisterOutputParams(GH_OutputParamManager _) { }

    protected override void BeforeSolveInstance()
    {
      if (_script is null) return;
      _script.BeforeSolve(this);
    }

    protected override void SolveInstance(IGH_DataAccess DA)
    {
      if (_script is null) return;
      _script.Solve(this, DA);
    }

    protected override void AfterSolveInstance()
    {
      if (_script is null) return;
      _script.AfterSolve(this);
    }

    public override void RemovedFromDocument(GH_Document document)
    {
      ProjectComponentPlugin.DisposeScript(this, _script);
      base.RemovedFromDocument(document);
    }

    public override BoundingBox ClippingBox
    {
      get
      {
        if (_script is null) return BoundingBox.Empty;
        return _script.GetClipBox(this);
      }
    }

    public override void DrawViewportWires(IGH_PreviewArgs args)
    {
      if (_script is null) return;
      _script.DrawWires(this, args);
    }

    public override void DrawViewportMeshes(IGH_PreviewArgs args)
    {
      if (_script is null) return;
      _script.DrawMeshes(this, args);
    }
  }
}
