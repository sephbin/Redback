using System;
using SD = System.Drawing;

using Rhino.Geometry;

using Grasshopper.Kernel;

namespace RhinoCodePlatform.Rhino3D.Projects.Plugin.GH
{
  public sealed class ProjectComponent_fabdeb8d : GH_Component
  {
    readonly SD.Bitmap _icon = default;
    readonly string _scriptData = "ew0KICAidHlwZSI6ICJzY3JpcHQiLA0KICAic2NyaXB0Ijogew0KICAgICJsYW5ndWFnZSI6IHsNCiAgICAgICJpZCI6ICIqLioucHl0aG9uIiwNCiAgICAgICJ2ZXJzaW9uIjogIjIuKi4qIg0KICAgIH0sDQogICAgInRpdGxlIjogIlRleHQgT2JqZWN0IiwNCiAgICAidGV4dCI6ICJJeU1qSXlCRGIyNXpkR0Z1ZEhNZ0l5TWpJdzBLWjJ4dlltRnNJRjlmZG1GeVgxOE5DbDlmZG1GeVgxOGdQU0I3RFFvSkltZDFhV1FpT2lJNU9ETmtPVFV4TVMwNE4yRTRMVFEzT1dZdFlUWTRPQzFrWTJWbU9EYzVZbVEzWkdNaUxBMEtDUTBLQ1NKdVlXMWxJam9pVkdWNGRDQlBZbXBsWTNRaUxBMEtDU0p1YVdOcmJtRnRaU0k2SWxSbGVIUWdUMkpxWldOMElpd05DZ2tpWkdWelkzSnBjSFJwYjI0aU9pSkRjbVZoZEdWeklHRWdkR1Y0ZENCdlltcGxZM1FnZEdoaGRDQmpZVzRnWW1VZ2NHRnljMlZrSUdKNUlHRnlZMmhLVTA5T0lpd05DZ2tpYVdOdmJpSTZJQ0puYUVOdmJuUmxiblJjWEVsamIyNHRWR1Y0ZEU5aWFtVmpkQzV3Ym1jaUxBMEtEUW9KSW5SaFltNWhiV1VpT2lKU1pXUmlZV05ySWl3TkNna2ljMlZqZEdsdmJpSTZJa0Z5WTJoS1UwOU9JaXdOQ2cwS0NTSnBibkIxZEhNaU9sc05DZ2tKZXlKdVlXMWxJam9pVUd4aGJtVWlMQWtKSW01cFkydHVZVzFsSWpvaVVDSXNDU0p2WW1wbFkzUkJZMk5sYzNNaU9pSnBkR1Z0SWl3SkltUmxjMk55YVhCMGFXOXVJam9pSWl3Z2ZTd05DZ2tKZXlKdVlXMWxJam9pVkdWNGRDSXNDUWtKSW01cFkydHVZVzFsSWpvaVZDSXNDU0p2WW1wbFkzUkJZMk5sYzNNaU9pSnBkR1Z0SWl3SkltUmxjMk55YVhCMGFXOXVJam9pSWl3Z2ZTd05DZ2xkTEEwS0NTSnZkWFJ3ZFhSeklqcGJEUW9KQ1hzaWJtRnRaU0k2SWxSbGVIUWdUMkpxWldOMElpd0pDU0p1YVdOcmJtRnRaU0k2SWs4aUxBa2laR1Z6WTNKcGNIUnBiMjRpT2lKaGNtTm9TbE5QVGlCVVpYaDBJRTlpYW1WamRDSjlMQTBLQ1YwTkNuME5DbDlmWVhWMGFHOXlYMThnUFNBaVFXNWtjbVYzTGtKMWRHeGxjaUlOQ2w5ZmRtVnljMmx2Ymw5ZklEMGdJakl3TWpRdU1ESXVNRElpRFFvakl5TWpJRU52Ym5OMFlXNTBjeUFqSXlNakRRcHBiWEJ2Y25RZ1VtaHBibThnWVhNZ2NnMEthVzF3YjNKMElISm9hVzV2YzJOeWFYQjBjM2x1ZEdGNElHRnpJSEp6RFFwcGJYQnZjblFnYW5OdmJnMEtVQ0E5SUZCTURRcFVJRDBnVkVVTkNtTnNZWE56SUdGeVkyaEtVMDlPVkdWNGREb05DaUFnSUNCa1pXWWdYMTlwYm1sMFgxOG9jMlZzWml3Z2JHOWpZWFJwYjI0c0lHTnZiblJsYm5RcE9nMEtJQ0FnSUNBZ0lDQnpaV3htTG14dlkyRjBhVzl1SUQwZ2JHOWpZWFJwYjI0TkNpQWdJQ0FnSUNBZ2MyVnNaaTVqYjI1MFpXNTBJRDBnYzNSeUtHTnZiblJsYm5RcERRb2dJQ0FnWkdWbUlGOWZjM1J5WDE4b2MyVnNaaWs2RFFvZ0lDQWdJQ0FnSUhKbGRIVnliaUFvSWp4QmNtTm9TbE5QVGlCVGRISnBibWNcdTAwMkJPaUFpSzNObGJHWXVZMjl1ZEdWdWRDa05DZzBLVkU4Z1BTQmhjbU5vU2xOUFRsUmxlSFFvVUN4VUtRPT0iLA0KICAgICJ1cmkiOiAicmhpbm9jb2RlOi8vL2dyYXNzaG9wcGVyLzEvZmFiZGViOGQtYjc5NC00OGU5LTg0YWItM2Y5OTIzZWRmYmYxLyIsDQogICAgImlkIjogImZhYmRlYjhkLWI3OTQtNDhlOS04NGFiLTNmOTkyM2VkZmJmMSIsDQogICAgIm5pY2tuYW1lIjogIlRleHQgT2JqZWN0IiwNCiAgICAiaW1hZ2UiOiB7DQogICAgICAibGlnaHQiOiB7DQogICAgICAgICJ0eXBlIjogInN2ZyIsDQogICAgICAgICJkYXRhIjogIlBITjJaeUJwWkQwaVRHRjVaWEpmTVNJZ1pHRjBZUzF1WVcxbFBTSk1ZWGxsY2lBeElpQjRiV3h1Y3owaWFIUjBjRG92TDNkM2R5NTNNeTV2Y21jdk1qQXdNQzl6ZG1jaUlIWnBaWGRDYjNnOUlqQWdNQ0F5TkNBeU5DSVx1MDAyQkNpQWdQR1JsWm5NXHUwMDJCQ2lBZ0lDQThjM1I1YkdVXHUwMDJCQ2lBZ0lDQWdJQzVqYkhNdE1Td2dMbU5zY3kweUlIc0tJQ0FnSUNBZ0lDQm1hV3hzT2lBalptWm1Pd29nSUNBZ0lDQjlDZ29nSUNBZ0lDQXVZMnh6TFRNZ2V3b2dJQ0FnSUNBZ0lHWnBiR3c2SUNNM01UQTVNR0U3Q2lBZ0lDQWdJSDBLQ2lBZ0lDQWdJQzVqYkhNdE5Dd2dMbU5zY3kweUlIc0tJQ0FnSUNBZ0lDQnZjR0ZqYVhSNU9pQXVNanNLSUNBZ0lDQWdmUW9LSUNBZ0lDQWdMbU5zY3kwMUlIc0tJQ0FnSUNBZ0lDQm1hV3hzT2lBalpXUXhZekkwT3dvZ0lDQWdJQ0I5Q2lBZ0lDQThMM04wZVd4bFBnb2dJRHd2WkdWbWN6NEtJQ0E4Y21WamRDQmpiR0Z6Y3owaVkyeHpMVFVpSUhnOUlqRXdJaUI1UFNJM0lpQjNhV1IwYUQwaU5DSWdhR1ZwWjJoMFBTSXhOQ0l2UGdvZ0lEeHlaV04wSUdOc1lYTnpQU0pqYkhNdE5TSWdlRDBpTkNJZ2VUMGlNeUlnZDJsa2RHZzlJakUySWlCb1pXbG5hSFE5SWpRaUx6NEtJQ0E4Y21WamRDQjRQU0l6SWlCNVBTSXlJaUIzYVdSMGFEMGlNU0lnYUdWcFoyaDBQU0kySWk4XHUwMDJCQ2lBZ1BISmxZM1FnZUQwaU5DSWdlVDBpTnlJZ2QybGtkR2c5SWpZaUlHaGxhV2RvZEQwaU1TSXZQZ29nSUR4eVpXTjBJSGc5SWpraUlIazlJamdpSUhkcFpIUm9QU0l4SWlCb1pXbG5hSFE5SWpFMElpOFx1MDAyQkNpQWdQSEpsWTNRZ2VEMGlNVEFpSUhrOUlqSXhJaUIzYVdSMGFEMGlOQ0lnYUdWcFoyaDBQU0l4SWk4XHUwMDJCQ2lBZ1BISmxZM1FnZUQwaU1UUWlJSGs5SWpnaUlIZHBaSFJvUFNJeElpQm9aV2xuYUhROUlqRTBJaThcdTAwMkJDaUFnUEhKbFkzUWdlRDBpTVRRaUlIazlJamNpSUhkcFpIUm9QU0kzSWlCb1pXbG5hSFE5SWpFaUx6NEtJQ0E4Y21WamRDQjRQU0l5TUNJZ2VUMGlNaUlnZDJsa2RHZzlJakVpSUdobGFXZG9kRDBpTlNJdlBnb2dJRHh5WldOMElIZzlJalFpSUhrOUlqSWlJSGRwWkhSb1BTSXhOaUlnYUdWcFoyaDBQU0l4SWk4XHUwMDJCQ2lBZ1BISmxZM1FnWTJ4aGMzTTlJbU5zY3kwMElpQjRQU0l4TUNJZ2VUMGlOaUlnZDJsa2RHZzlJakVpSUdobGFXZG9kRDBpTVRVaUx6NEtJQ0E4Y21WamRDQmpiR0Z6Y3owaVkyeHpMVFFpSUhnOUlqVWlJSGs5SWpZaUlIZHBaSFJvUFNJMUlpQm9aV2xuYUhROUlqRWlMejRLSUNBOGNtVmpkQ0JqYkdGemN6MGlZMnh6TFRJaUlIZzlJalVpSUhrOUlqTWlJSGRwWkhSb1BTSXhOQ0lnYUdWcFoyaDBQU0l4SWk4XHUwMDJCQ2lBZ1BISmxZM1FnWTJ4aGMzTTlJbU5zY3kwMElpQjRQU0l4TmlJZ2VUMGlOaUlnZDJsa2RHZzlJak1pSUdobGFXZG9kRDBpTVNJdlBnb2dJRHhuUGdvZ0lDQWdQSEpsWTNRZ1kyeGhjM005SW1Oc2N5MHhJaUI0UFNJNExqVWlJSGs5SWpJd0xqVWlJSGRwWkhSb1BTSXlJaUJvWldsbmFIUTlJaklpTHo0S0lDQWdJRHh3WVhSb0lHTnNZWE56UFNKamJITXRNeUlnWkQwaWJURXdMREl4ZGpGb0xURjJMVEZvTVcweExURm9MVE4yTTJnemRpMHphREJhSWk4XHUwMDJCQ2lBZ1BDOW5QZ29nSUR4blBnb2dJQ0FnUEhKbFkzUWdZMnhoYzNNOUltTnNjeTB4SWlCNFBTSXlMalVpSUhrOUlqWXVOU0lnZDJsa2RHZzlJaklpSUdobGFXZG9kRDBpTWlJdlBnb2dJQ0FnUEhCaGRHZ2dZMnhoYzNNOUltTnNjeTB6SWlCa1BTSnROQ3czZGpGb0xURjJMVEZvTVcweExURm9MVE4yTTJnemRpMHphREJhSWk4XHUwMDJCQ2lBZ1BDOW5QZ29nSUR4blBnb2dJQ0FnUEhKbFkzUWdZMnhoYzNNOUltTnNjeTB4SWlCNFBTSTRMalVpSUhrOUlqWXVOU0lnZDJsa2RHZzlJaklpSUdobGFXZG9kRDBpTWlJdlBnb2dJQ0FnUEhCaGRHZ2dZMnhoYzNNOUltTnNjeTB6SWlCa1BTSnRNVEFzTjNZeGFDMHhkaTB4YURGdE1TMHhhQzB6ZGpOb00zWXRNMmd3V2lJdlBnb2dJRHd2Wno0S0lDQThaejRLSUNBZ0lEeHlaV04wSUdOc1lYTnpQU0pqYkhNdE1TSWdlRDBpTWk0MUlpQjVQU0l4TGpVaUlIZHBaSFJvUFNJeUlpQm9aV2xuYUhROUlqSWlMejRLSUNBZ0lEeHdZWFJvSUdOc1lYTnpQU0pqYkhNdE15SWdaRDBpYlRRc01uWXhhQzB4ZGkweGFERnRNUzB4YUMwemRqTm9NMVl4YURCYUlpOFx1MDAyQkNpQWdQQzluUGdvZ0lEeG5QZ29nSUNBZ1BISmxZM1FnWTJ4aGMzTTlJbU5zY3kweElpQjRQU0l4T1M0MUlpQjVQU0l4TGpVaUlIZHBaSFJvUFNJeUlpQm9aV2xuYUhROUlqSWlMejRLSUNBZ0lEeHdZWFJvSUdOc1lYTnpQU0pqYkhNdE15SWdaRDBpYlRJeExESjJNV2d0TVhZdE1XZ3hiVEV0TVdndE0zWXphRE5XTVdnd1dpSXZQZ29nSUR3dlp6NEtJQ0E4Wno0S0lDQWdJRHh5WldOMElHTnNZWE56UFNKamJITXRNU0lnZUQwaU1Ua3VOU0lnZVQwaU5pNDFJaUIzYVdSMGFEMGlNaUlnYUdWcFoyaDBQU0l5SWk4XHUwMDJCQ2lBZ0lDQThjR0YwYUNCamJHRnpjejBpWTJ4ekxUTWlJR1E5SW0weU1TdzNkakZvTFRGMkxURm9NVzB4TFRGb0xUTjJNMmd6ZGkwemFEQmFJaThcdTAwMkJDaUFnUEM5blBnb2dJRHhuUGdvZ0lDQWdQSEpsWTNRZ1kyeGhjM005SW1Oc2N5MHhJaUI0UFNJeE15NDFJaUI1UFNJMkxqVWlJSGRwWkhSb1BTSXlJaUJvWldsbmFIUTlJaklpTHo0S0lDQWdJRHh3WVhSb0lHTnNZWE56UFNKamJITXRNeUlnWkQwaWJURTFMRGQyTVdndE1YWXRNV2d4YlRFdE1XZ3RNM1l6YUROMkxUTm9NRm9pTHo0S0lDQThMMmNcdTAwMkJDaUFnUEdjXHUwMDJCQ2lBZ0lDQThjbVZqZENCamJHRnpjejBpWTJ4ekxURWlJSGc5SWpFekxqVWlJSGs5SWpJd0xqVWlJSGRwWkhSb1BTSXlJaUJvWldsbmFIUTlJaklpTHo0S0lDQWdJRHh3WVhSb0lHTnNZWE56UFNKamJITXRNeUlnWkQwaWJURTFMREl4ZGpGb0xURjJMVEZvTVcweExURm9MVE4yTTJnemRpMHphREJhSWk4XHUwMDJCQ2lBZ1BDOW5QZ284TDNOMlp6ND0iDQogICAgICB9DQogICAgfSwNCiAgICAiZ3JvdXAiOiAiQXJjaEpTT04iLA0KICAgICJpbnB1dHMiOiBbDQogICAgICB7DQogICAgICAgICJuYW1lIjogIlBMIiwNCiAgICAgICAgInR5cGUiOiB7DQogICAgICAgICAgIm5hbWUiOiAiU3lzdGVtLk9iamVjdCINCiAgICAgICAgfSwNCiAgICAgICAgInByZXR0eSI6ICJQbGFuZSIsDQogICAgICAgICJkZXNjIjogInJoaW5vc2NyaXB0c3ludGF4IGdlb21ldHJ5Ig0KICAgICAgfSwNCiAgICAgIHsNCiAgICAgICAgIm5hbWUiOiAiVEUiLA0KICAgICAgICAidHlwZSI6IHsNCiAgICAgICAgICAibmFtZSI6ICJTeXN0ZW0uT2JqZWN0Ig0KICAgICAgICB9LA0KICAgICAgICAicHJldHR5IjogIlRleHQiLA0KICAgICAgICAiZGVzYyI6ICJyaGlub3NjcmlwdHN5bnRheCBnZW9tZXRyeSINCiAgICAgIH0NCiAgICBdLA0KICAgICJvdXRwdXRzIjogWw0KICAgICAgew0KICAgICAgICAibmFtZSI6ICJUTyIsDQogICAgICAgICJ0eXBlIjogew0KICAgICAgICAgICJuYW1lIjogIlN5c3RlbS5PYmplY3QiDQogICAgICAgIH0sDQogICAgICAgICJzdHJpY3QiOiBmYWxzZSwNCiAgICAgICAgInByZXR0eSI6ICJUZXh0IE9iamVjdCIsDQogICAgICAgICJkZXNjIjogInJoaW5vc2NyaXB0c3ludGF4IGdlb21ldHJ5Ig0KICAgICAgfQ0KICAgIF0NCiAgfQ0KfQ==";
    readonly dynamic _script;

    public override Guid ComponentGuid { get; } = new Guid("fabdeb8d-b794-48e9-84ab-3f9923edfbf1");

    public override GH_Exposure Exposure { get; } = GH_Exposure.primary;

    public override bool Obsolete { get; } = false;

    protected override SD.Bitmap Icon => _icon;

    public ProjectComponent_fabdeb8d() : base(
        name: "Text Object",
        nickname: "Text Object",
        description: "",
        category: "Redback-Beta",
        subCategory: "ArchJSON"
        )
    {
      bool success = ProjectComponentPlugin.TryCreateScript(this, _scriptData, out _script);
      if (success)
      {
        ProjectComponentPlugin.TryCreateScriptIcon(_script, out _icon);
      }
      else
      {
        AddRuntimeMessage(GH_RuntimeMessageLevel.Error, "Scripting platform is not ready.");
      }
    }

    protected override void RegisterInputParams(GH_InputParamManager _) { }

    protected override void RegisterOutputParams(GH_OutputParamManager _) { }

    protected override void BeforeSolveInstance()
    {
      if (_script is null) return;
      _script.BeforeSolve(this);
    }

    protected override void SolveInstance(IGH_DataAccess DA)
    {
      if (_script is null) return;
      _script.Solve(this, DA);
    }

    protected override void AfterSolveInstance()
    {
      if (_script is null) return;
      _script.AfterSolve(this);
    }

    public override void RemovedFromDocument(GH_Document document)
    {
      ProjectComponentPlugin.DisposeScript(this, _script);
      base.RemovedFromDocument(document);
    }

    public override BoundingBox ClippingBox
    {
      get
      {
        if (_script is null) return BoundingBox.Empty;
        return _script.GetClipBox(this);
      }
    }

    public override void DrawViewportWires(IGH_PreviewArgs args)
    {
      if (_script is null) return;
      _script.DrawWires(this, args);
    }

    public override void DrawViewportMeshes(IGH_PreviewArgs args)
    {
      if (_script is null) return;
      _script.DrawMeshes(this, args);
    }
  }
}
